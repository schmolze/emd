<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Welcome</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<hr/>

<h1>Welcome</h1>

<p>Welcome to the <strong>EMDomics</strong> package! This vignette will explain the functionality of the package through the creation and analysis of a toy data set.</p>

<h1>Earth Mover&#39;s Distance</h1>

<p><strong>EMDomics</strong> analyzes differences in genomics data between two groups. Typically the data will be gene expression levels from array- or sequence-based experiments, but other scenarios are possible. In a real experiment, the two groups might be test vs. control, sensitive vs. resistant, etc., but here we&#39;ll just call them &ldquo;group A&rdquo; and &ldquo;group B&rdquo;. Typically you&#39;ll be analyzing differences across multiple genes, but we&#39;ll start with a single gene to get a feel for how the Earth Mover&#39;s Distance (EMD) algorithm works.</p>

<p>We&#39;ll create a vector of expression data for 100 samples, and we&#39;ll call the first 50 samples &ldquo;group A&rdquo; and the second 50 &ldquo;group B&rdquo;:</p>

<pre><code class="r">exp_data &lt;- rnorm(100)
names(exp_data) &lt;- paste(&quot;sample&quot;, 1:100)

groupA &lt;- names(exp_data)[1:50]
groupB &lt;- names(exp_data)[51:100]
</code></pre>

<p>We&#39;ll take a quick look at the two distributions using <code>ggplot</code>:</p>

<pre><code class="r">library(ggplot2)
df &lt;- as.data.frame(exp_data)
df$group[1:50] &lt;- &quot;A&quot;
df$group[51:100] &lt;- &quot;B&quot;
ggplot(df, aes(exp_data, fill=group)) + geom_density(alpha=0.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-2"/> </p>

<p>We shouldn&#39;t expect the two groups to look too different, since we&#39;re just sampling from the normal distribution. Intuitively, the &ldquo;work&rdquo; required to transform one distribution into the other should be low. We can calculate the EMD score for this single gene using the function <code>calculate_emd_gene</code>:</p>

<pre><code class="r">library(EMDomics)
</code></pre>

<pre><code>## Error: there is no package called &#39;EMDomics&#39;
</code></pre>

<pre><code class="r">calculate_emd_gene(exp_data, groupA, groupB)
</code></pre>

<pre><code>## Error: could not find function &quot;calculate_emd_gene&quot;
</code></pre>

<p>Now we&#39;ll modify the expression data for <code>group A</code> and see how the EMD score changes. We&#39;ll randomly add or subtract 2 from each data point in <code>group A</code>:</p>

<pre><code class="r">exp_data2 &lt;- exp_data
mod_vec &lt;- sample(c(2,-2), 50, replace=TRUE)
exp_data2[1:50] &lt;- exp_data2[1:50] + mod_vec
</code></pre>

<p>Let&#39;s again visualize the two distributions and calculate the EMD score:</p>

<pre><code class="r">df &lt;- as.data.frame(exp_data2)
df$group[1:50] &lt;- &quot;A&quot;
df$group[51:100] &lt;- &quot;B&quot;
ggplot(df, aes(exp_data2, fill=group)) + geom_density(alpha=0.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/> </p>

<pre><code class="r">calculate_emd_gene(exp_data2, groupA, groupB)
</code></pre>

<pre><code>## Error: could not find function &quot;calculate_emd_gene&quot;
</code></pre>

<p>The EMD score is larger, reflecting the increased work needed to transform one distribution into the other.</p>

<h1>Analyzing Significance</h1>

<p>The EMD score increases as the two distributions become increasingly dissimilar, but we have no framework for estimating the significance of a particular EMD score. <strong>EMDomics</strong> uses a permutation-based method to calculate a q-value that is interpreted analogously to a p-value. To access the full functionality of the package, we&#39;ll use the function <code>calculate_emd</code>. </p>

<p>We&#39;ll first create a matrix of gene expression data for 100 samples (tumors, patients, etc.) and 100 genes. We&#39;ll just sample from the normal distribution for now. The first 50 samples will be our &ldquo;group A&rdquo;, and the second 50 will be &ldquo;group B&rdquo;.</p>

<pre><code class="r">data &lt;- matrix(rnorm(10000), nrow=100, ncol=100)
rownames(data) &lt;- paste(&quot;gene&quot;, 1:100, sep=&quot;&quot;)
colnames(data) &lt;- paste(&quot;sample&quot;, 1:100, sep=&quot;&quot;)

groupA &lt;- colnames(data)[1:50]
groupB &lt;- colnames(data)[51:100]
</code></pre>

<p>Now we can call <code>calculate_emd</code>. We&#39;ll only use 10 permutations for the purposes of this vignette, but in actual experiments using at least 100 permutations is advised.</p>

<pre><code class="r">results &lt;- calculate_emd(data, groupA, groupB, nperm=10)
</code></pre>

<pre><code>## Error: could not find function &quot;calculate_emd&quot;
</code></pre>

<p>Most of the time, you&#39;ll be interested in the <code>emd</code> matrix returned as a member of the return object:</p>

<pre><code class="r">emd &lt;- results$emd
</code></pre>

<pre><code>## Error: object &#39;results&#39; not found
</code></pre>

<pre><code class="r">head(emd)
</code></pre>

<pre><code>## Error: object &#39;emd&#39; not found
</code></pre>

<p>This matrix lists the emd score, the fold change (defined as log2(2<sup>meanA<sup>/2<sup>meanB<sup>)),</sup></sup></sup></sup> and the q-value for each gene in the data set. Because we&#39;re not analyzing many genes and the data is randomly generated, there will likely be some significant q-values in the results simply by chance. We can order the <code>emd</code> matrix by q-value:</p>

<pre><code class="r">emd2 &lt;- emd[(order(emd[,&quot;q-value&quot;])),]
</code></pre>

<pre><code>## Error: object &#39;emd&#39; not found
</code></pre>

<pre><code class="r">head(emd2)
</code></pre>

<pre><code>## Error: object &#39;emd2&#39; not found
</code></pre>

<p>Note the correlation of significant q-values with relatively large EMD scores and with relatively high fold change. </p>

<p>q-values of 0 are adjusted to 1/[number of permutations+1]. Keep this in mind
when choosing a value for <code>nperm</code> in a call to <code>calculate_emd</code>. In general,
the default value of 100 is reasonable.</p>

<h1>Visualization</h1>

<p><strong>EMDomics</strong> includes a few visualization functions. The function <code>plot_density</code> will display the density distributions of &ldquo;group A&rdquo; and &ldquo;group B&rdquo; for a given gene, along with the EMD score. We can compare the gene with the largest EMD score and the gene with the smallest EMD score, for example:</p>

<pre><code class="r">emd3 &lt;- emd[(order(emd[,&quot;emd&quot;])),]
</code></pre>

<pre><code>## Error: object &#39;emd&#39; not found
</code></pre>

<pre><code class="r">smallest_gene &lt;- rownames(emd3)[1]
</code></pre>

<pre><code>## Error: object &#39;emd3&#39; not found
</code></pre>

<pre><code class="r">biggest_gene &lt;- rownames(emd3)[nrow(emd3)]
</code></pre>

<pre><code>## Error: object &#39;emd3&#39; not found
</code></pre>

<pre><code class="r">plot_density(results, smallest_gene)
</code></pre>

<pre><code>## Error: could not find function &quot;plot_density&quot;
</code></pre>

<pre><code class="r">plot_density(results, biggest_gene)
</code></pre>

<pre><code>## Error: could not find function &quot;plot_density&quot;
</code></pre>

<p>The smallest EMD score reflects two distributions that are nearly the same overall shape, while the largest EMD score corresponds to distributions that differ significantly.</p>

<p>We can plot a histogram of all the calculated EMD scores with the function <code>plot_perms</code>:</p>

<pre><code class="r">plot_perms(results)
</code></pre>

<pre><code>## Error: could not find function &quot;plot_perms&quot;
</code></pre>

<p>This plot can help intuitively understand the relative significance of an EMD score. For example, almost all the randomly permuted EMD scores are smaller than the largest calculated EMD score plotted above.</p>

<p>In a similar vein, the function <code>plot_emdnull</code> plots the null distribution (the median of the permuted EMD scores) for each gene vs. the calculated EMD score (the line x=y is superimposed in red):</p>

<pre><code class="r">plot_emdnull(results)
</code></pre>

<pre><code>## Error: could not find function &quot;plot_emdnull&quot;
</code></pre>

<h1>Wrapping Up</h1>

<p>This concludes the <strong>EMDomics</strong> vignette. For additional information, please consult the reference manual.</p>

</body>

</html>

